## Comparisons

vimhelp was chosen because it's modern (at least much more so than [vimdoc](https://vimdoc.sourceforge.net/)) and provides some nice features like the ability to switch light/dark modes, and presenting a table of contents sidebar. It's designed to work as as server but has an offline generation mode. We made a fork to make certain necessary changes to make offline mode generation better and to have the page actually support MacVim and have the correct information at the footer, etc.

Neovim's documentation generation tool (hosted at https://neovim.io/doc/user/) was also an option and it has certain nice features, but after investigating it for a bit, it became obvious that it would be quite hard to work around the restrictions (see [this comment](https://github.com/neovim/neovim/pull/20690#issuecomment-1458796967)) due to its tree-sitter logic requiring a tighter syntax than Vim documentation currently actually uses.

There were other tools like vim-jp's https://github.com/vim-jp/vimdoc-en, but vimhelp seemed to be the most used and provided the features we need.

## Offline functionality

vimhelp was modified to export a tags.json file during build. This file embeds all the tags mapping which allows us to query which tag should map where, without needing to rely on a dynamic server like vimhelp.org uses.

- We also generate a redirect.html page which has tags.json embedded, and it allows us to do client-side redirecting. If you go to `redirect.html?tag=showdefinition()`, it will look up the tag in JavaScript and redirect the page as need be. This allows us to make a permalink that will always point to the correct tag location even if the tag gets moved to another file later on. Only issue is that this relies on JavaScript being enabled (which some users may have disabled).
- We also use tags.json to faciliate the "Go to keyword" search box, which on vimhelp.org is a server query. It works by downloading the JSON file and doing client-side matching in JS.

## CI

Publish the documentation using GitHub pages for simplicity and so we don't have to run a server. Since everything is generated by vimhelp, we don't really need an intermediate step of pushing to a gh-pages branch first. Instead, GitHub has a newer feature that allows us to directly publish the page as an artifact and deploy from it, thus saving us from having to push to a gh-pages branch, which would actually have bogged down the repo by storing useless history.

Currently it's configured to run nightly as of this writing, but it will only deploy the page if something has changed (otherwise it will just build the artifact but does not deploy it) to help preserve browser caching.
